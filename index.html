<html>
  <head>
    <meta name="viewport" content="width=700"/>
    <title>language ruler</title>
    <style type="text/css"> 
      #container {
        margin-left: 20px;
        width: 700px;
        font-family: arial,sans-serif-light;
        float:left;
      }

      @media only screen and (min-width: 1200px) {
        /* For desktop: */
        #leftspaces {
          width: 350px; 
          height: 1px;
          float:left;
        }

        #footer {
          display:absolute;
          margin-top:630px;
          margin-left:700px;
          width: 250px;
          float:left;
          font-family: arial,sans-serif-light;
          font-size: 13px;color:#a6a7a8;
        }
      }

      @media only screen and (max-width: 1200px) {
        /* For mobile phones: */
        #leftspaces {
          width: 0px; 
          height: 0px;
          /*float:left;*/
        }

        #footer {
          margin-top:720px;
          margin-left:30px;
          float:left; 
          font-family: arial,sans-serif-light;
          font-size: 13px;color:#a6a7a8;
          text-align:left;width:700px;
        }
      }

      #donut_single {
        width: 700px; 
        height: 700px;
        position: absolute;
      }

      .box {
        font-family: arial,sans-serif-light;
        overflow: hidden;
        height: 50px;
        width: 100px;
        position: absolute;
      }

      .boxB {
        font-family: arial,sans-serif-light;
        overflow: hidden;
        height: 45px;
        width: 90px;
        position: absolute;
      }

      .uppertext {
        font-size: 12px;
        margin: 3px;
      }
      .lowertext {
        font-size: 13px;
        font-weight: bold;
        margin: 3px;
      }

      .uppertextB {
        font-size: 10px;
        margin: 2px;
      }
      .lowertextB {
        font-size: 12px;
        font-weight: bold;
        margin: 2px;
      }
      *:focus {
        outline: none;
      }


    </style>
  </head>
  <body>
    <div id="leftspaces"></div>
    <div id="container">
      <div id="donut_single"></div>
      <div id="box-1" class="box" style="margin-left: 272px;margin-top: 10px;background-color:#ffffff;
      height: 72px;width: 128px;"> 
        <div id="lang-1" class="uppertext">Source Language</div>
        <div id="text-1" >
          <form name="translateForm" onsubmit="return false;">
            <input id="source" name="textfield" type="text" placeholder="Enter Text" size=13 autocomplete="off"
            style="margin: 3px;font-size: 16px;border:0;"/>
          </form>  
        </div>
      </div>

      <div id="box-1B" class="boxB" style="margin-left: 290px;margin-top: 98px;background-color:#ffffff"> 
        <div id="lang-1B" class="uppertextB"></div>
        <div id="text-1B" class="lowertextB"></div>
      </div>

      <div id="box-2" class="box" style="margin-left: 420px;margin-top: 60px;background-color:#ffffff"> 
        <div id="lang-2" class="uppertext" ></div>
        <div id="text-2" class="lowertext" ></div>
      </div>    
      
      <div id="box-2B" class="boxB" style="margin-left: 405px;margin-top: 124px;background-color:#ffffff"> 
        <div id="lang-2B" class="uppertextB"></div>
        <div id="text-2B" class="lowertextB"></div>
      </div>

      <div id="box-3" class="box" style="margin-left: 545px;margin-top: 160px;background-color:#ffffff"> 
        <div id="lang-3" class="uppertext"></div>
        <div id="text-3" class="lowertext"></div>
      </div>    
      
      <div id="box-3B" class="boxB" style="margin-left: 490px;margin-top: 220px;background-color:#ffffff"> 
        <div id="lang-3B" class="uppertextB"></div>
        <div id="text-3B" class="lowertextB"></div>
      </div>

      <div id="box-4" class="box" style="margin-left: 590px;margin-top: 310px;background-color:#ffffff"> 
        <div id="lang-4" class="uppertext"></div>
        <div id="text-4" class="lowertext"></div>
      </div>    
      
      <div id="box-4B" class="boxB" style="margin-left: 490px;margin-top: 313px;background-color:#ffffff"> 
        <div id="lang-4B" class="uppertextB"></div>
        <div id="text-4B" class="lowertextB"></div>
      </div>

      <div id="box-5" class="box" style="margin-left: 535px;margin-top: 470px;background-color:#ffffff"> 
        <div id="lang-5" class="uppertext"></div>
        <div id="text-5" class="lowertext"></div>
      </div>    
      
      <div id="box-5B" class="boxB" style="margin-left: 490px;margin-top: 413px;background-color:#ffffff"> 
        <div id="lang-5B" class="uppertextB"></div>
        <div id="text-5B" class="lowertextB"></div>
      </div>

      <div id="box-6" class="box" style="margin-left: 420px;margin-top: 560px;background-color:#ffffff"> 
        <div id="lang-6" class="uppertext"></div>
        <div id="text-6" class="lowertext"></div>
      </div>    
      
      <div id="box-6B" class="boxB" style="margin-left: 405px;margin-top: 500px;background-color:#ffffff"> 
        <div id="lang-6B" class="uppertextB"></div>
        <div id="text-6B" class="lowertextB"></div>
      </div>

      <div id="box-7" class="box" style="margin-left: 284px;margin-top: 590px;background-color:#ffffff"> 
        <div id="lang-7" class="uppertext"></div>
        <div id="text-7" class="lowertext"></div>
      </div>

      <div id="box-7B" class="boxB" style="margin-left: 290px;margin-top: 528px;background-color:#ffffff"> 
        <div id="lang-7B" class="uppertextB"></div>
        <div id="text-7B" class="lowertextB"></div>
      </div>

      <div id="box-8" class="box" style="margin-left: 150px;margin-top: 560px;background-color:#ffffff"> 
        <div id="lang-8" class="uppertext"></div>
        <div id="text-8" class="lowertext"></div>
      </div>    
      
      <div id="box-8B" class="boxB" style="margin-left: 180px;margin-top: 500px;background-color:#ffffff"> 
        <div id="lang-8B" class="uppertextB"></div>
        <div id="text-8B" class="lowertextB"></div>
      </div>

      <div id="box-9" class="box" style="margin-left: 40px;margin-top: 470px;background-color:#ffffff"> 
        <div id="lang-9" class="uppertext"></div>
        <div id="text-9" class="lowertext"></div>
      </div>    
      
      <div id="box-9B" class="boxB" style="margin-left: 88px;margin-top: 413px;background-color:#ffffff"> 
        <div id="lang-9B" class="uppertextB"></div>
        <div id="text-9B" class="lowertextB"></div>
      </div>

      <div id="box-10" class="box" style="margin-left: -10px;margin-top: 310px;background-color:#ffffff"> 
        <div id="lang-10" class="uppertext"></div>
        <div id="text-10" class="lowertext"></div>
      </div>    
      
      <div id="box-10B" class="boxB" style="margin-left: 100px;margin-top: 313px;background-color:#ffffff"> 
        <div id="lang-10B" class="uppertextB"></div>
        <div id="text-10B" class="lowertextB"></div>
      </div>

      <div id="box-11" class="box" style="margin-left: 44px;margin-top: 160px;background-color:#ffffff"> 
        <div id="lang-11" class="uppertext"></div>
        <div id="text-11" class="lowertext"></div>
      </div>    
      
      <div id="box-11B" class="boxB" style="margin-left: 88px;margin-top: 220px;background-color:#ffffff"> 
        <div id="lang-11B" class="uppertextB"></div>
        <div id="text-11B" class="lowertextB"></div>
      </div>
         
      <div id="box-12" class="box" style="margin-left: 150px;margin-top: 60px;background-color:#ffffff"> 
        <div id="lang-12" class="uppertext"></div>
        <div id="text-12" class="lowertext"></div>
      </div>    
      
      <div id="box-12B" class="boxB" style="margin-left: 180px;margin-top: 124px;background-color:#ffffff"> 
        <div id="lang-12B" class="uppertextB"></div>
        <div id="text-12B" class="lowertextB"></div>
      </div>
      <div id="footer">Made by: yuchen wang &amp; mok wai keong</div>
    </div>


<!--[if lt IE 10]>
<script type="text/javascript">
    window.location = "http://languageruler.com/error.html";
</script>
<![endif]-->

<!-- java script code to call google services  -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
var totalTranslation=12;
var googleKey = "AIzaSyCX_pR5Nt89YG6-wzE-CNArYikjfWpUu9w";
var acceptableConfidence = 0.1;
var counter=0;
var circle=0;
var translatedLanguages=[''];
var translatedLanguagesText=[''];
var OrignateText = "";
var OrignateLanguage;
var s;
var typingTimer;
var typingTimer1;
var processing=false;
$(document).ready(function(){
    $('#source').bind('input propertychange', function() { 
      var input = $('#source').val();
      if (input!==s){
        clear();
        $('#lang-1').append("Source Language");
        s = $('#source').val().trim();
        clearTimeout(typingTimer);
        typingTimer = setTimeout(function() { 
          if($('#source').val().trim() === s.trim()){ 
            start(s.trim());
          }
        }, 1000); // 1 sec delay to check.  
      }
    });

    var width = screen.width;
    if (width>1200){
      $("#leftspaces").css("width", (width - 700) / 2);
    }

});

var start = function(sourceText){
  if (sourceText.length>0){
    callService(sourceText);   
  }
};
  
var clear = function(){
  counter = 1;
  circle = 1;
  processing = false;
  translatedLanguages=[''];
  translatedLanguagesText=[''];
  OrignateText = "";
  $('.uppertext').empty();
  $('.lowertext').empty();
  $('.uppertextB').empty();
  $('.lowertextB').empty();
};

var callService = function(sourceText){
  var apiurl = 'https://www.googleapis.com/language/translate/v2/detect';
    $.ajax({
      url: apiurl,
      dataType: 'jsonp',
      data: {
          key: googleKey,
          q: sourceText,
      },
      success: function(response) {
        var confidence = response.data.detections[0][0].confidence;
        // if (confidence < acceptableConfidence){
          // alert("Language can't be detected.");
          // return;
        // }
        var sourceLanguage = response.data.detections[0][0].language;
        OrignateLanguage = sourceLanguage;
        OrignateText =  sourceText;
        processing = true;
        $('#lang-1').empty();
        $('#lang-1').append(OrignateLanguage.toUpperCase());
        var random = randomLanguage(sourceLanguage);
        translateService(sourceText, sourceLanguage, languages[random][1], languages[random][0]);
        }
    });
};

var translateService = function(sourceText, sourceLanguage, targetLanguage, targetLanguageText){
  var apiurl = 'https://www.googleapis.com/language/translate/v2';
    $.ajax({
      url: apiurl,
      dataType: 'jsonp',
      data: {
          key: googleKey,
          source: sourceLanguage,
          target: targetLanguage,
          q: sourceText,
      },
      success: function(response) {
        if (!response.hasOwnProperty("data"))
        {
          console.log(response);
          alert("Ops.. Try again.");
          clear();
          return;
        }

        var targetText = response.data.translations[0].translatedText;
        translatedLanguages.push(targetLanguage);
        translatedLanguagesText.push(targetLanguageText);
        counter += 1;

        if (circle===1)
        {
          // $('#lang-'.concat(counter)).append(targetLanguage.toUpperCase());  
          $('#lang-'.concat(counter)).append(targetLanguageText);  
          $('#text-'.concat(counter)).append(targetText);
        }
        else
        {
          // $('#lang-'.concat(counter).concat('B')).append(targetLanguage.toUpperCase());  
          $('#lang-'.concat(counter).concat('B')).append(targetLanguageText);  
          $('#text-'.concat(counter).concat('B')).append(targetText);
        }
        
        if (circle===1 && counter<=totalTranslation && processing === true)
        {
          var random = randomLanguage(targetLanguage);
          translateService(targetText, targetLanguage, languages[random][1], languages[random][0]);
        }
        else if (circle===1 && counter===(totalTranslation+1) && processing === true)
        {
          translateService(targetText, targetLanguage, OrignateLanguage, OrignateLanguage); 
          circle += 1;
          counter = 0;
        }
        else if (circle===2 && counter<=totalTranslation && processing === true)
        {
          translateService(targetText, targetLanguage, translatedLanguages[counter], translatedLanguagesText[counter]);
        }

        if (circle===2 && counter==totalTranslation && processing === true)
        {
          processing === false;
        }

      }
    });
};
</script>

<!-- languages supported  -->
<script type="text/javascript">
   var languages = [
    ['Afrikaans','af'],
    ['Albanian','sq'],
    ['Arabic','ar'],
    ['Armenian','hy'],
    ['Azerbaijani','az'],
    // ['Basque','eu'],
    // ['Belarusian','be'],
    // ['Bengali','bn'],
    ['Bosnian','bs'],
    ['Bulgarian','bg'],
    ['Catalan','ca'],
    // ['Cebuano','ceb'],
    // ['Chichewa','ny'],
    ['Chinese Simplified','zh-CN'],
    ['Chinese Traditional','zh-TW'],
    ['Croatian','hr'],
    ['Czech','cs'],
    ['Danish','da'],
    ['Dutch','nl'],
    ['English','en'],
    // ['Esperanto','eo'],
    // ['Estonian','et'],
    ['Filipino','tl'],
    ['Finnish','fi'],
    ['French','fr'],
    // ['Galician','gl'],
    ['Georgian','ka'],
    ['German','de'],
    ['Greek','el'],
    ['Gujarati','gu'],
    // ['Haitian Creole','ht'],
    ['Hausa','ha'],
    ['Hebrew','iw'],
    ['Hindi','hi'],
    // ['Hmong','hmn'],
    ['Hungarian','hu'],
    ['Icelandic','is'],
    ['Igbo','ig'],
    ['Indonesian','id'],
    ['Irish','ga'],
    ['Italian','it'],
    ['Japanese','ja'],
    ['Javanese','jw'],
    ['Kannada','kn'],
    ['Kazakh','kk'],
    // ['Khmer','km'],
    ['Korean','ko'],
    ['Lao','lo'],
    ['Latin','la'],
    ['Latvian','lv'],
    ['Lithuanian','lt'],
    ['Macedonian','mk'],
    ['Malagasy','mg'],
    ['Malay','ms'],
    // ['Malayalam','ml'],
    ['Maltese','mt'],
    ['Maori','mi'],
    ['Marathi','mr'],
    ['Mongolian','mn'],
    ['Myanmar (Burmese)','my'],
    ['Nepali','ne'],
    ['Norwegian','no'],
    ['Persian','fa'],
    ['Polish','pl'],
    ['Portuguese','pt'],
    // ['Punjabi','ma'],
    ['Romanian','ro'],
    ['Russian','ru'],
    ['Serbian','sr'],
    // ['Sesotho','st'],
    // ['Sinhala','si'],
    ['Slovak','sk'],
    ['Slovenian','sl'],
    ['Somali','so'],
    ['Spanish','es'],
    ['Sudanese','su'],
    // ['Swahili','sw'],
    ['Swedish','sv'],
    ['Tajik','tg'],
    ['Tamil','ta'],
    // ['Telugu','te'],
    ['Thai','th'],
    ['Turkish','tr'],
    ['Ukrainian','uk'],
    ['Urdu','ur'],
    ['Uzbek','uz'],
    ['Vietnamese','vi'],
    ['Welsh','cy'],
    ['Yiddish','yi'],
    // ['Yoruba','yo'],
    // ['Zulu','zu']
  ];

var randomLanguage = function(sourceLanguage){
  var random;
  do {
    random = Math.floor(((Math.random() * 1000)%languages.length));
  } while (languages[random][1]===OrignateLanguage||translatedLanguages.indexOf(languages[random][1])>=0);
  return random;
};

 </script>

<!-- java script code to call draw google pie chart  -->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {

        var data = google.visualization.arrayToDataTable([
          ['Effort', 'Amount given'],
          ['this',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
          ['',     100],
        ]);

        var options = {
          pieHole: 0.55,
          legend: 'none',
          pieSliceText: 'none',
          pieStartAngle: 345,
          tooltip: { trigger: 'none' },
          slices: {
            0: { color: '#f8ff7e' },
            1: { color: '#c3ff81' },
            2: { color: '#2eff83' },
            3: { color: '#3affb9' },
            4: { color: '#4bffff' },
            5: { color: '#75b6ff' },
            6: { color: '#73b4ff' },
            7: { color: '#8567fe' },
            8: { color: '#fd58fd' },
            9: { color: '#ff55fb' },
            10: { color: '#ff66ae' },
            11: { color: '#ff6b76' },
            12: { color: '#ffb479' },
          },
          chartArea:{left:20,top:20,width:'90%',height:'90%'},
          enableInteractivity:false,
        };

        var chart = new google.visualization.PieChart(document.getElementById('donut_single'));
        chart.draw(data, options);
      }

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77715022-2', 'auto');
  ga('send', 'pageview');

  </script>

</body>
</html>